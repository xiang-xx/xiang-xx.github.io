<!doctype html><html lang=zh-CN><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=theme-color content="dark"><title>术语命名混乱问题及解决方案 | XX Blog</title><meta property="og:site_name" content="XX Blog"><meta property="og:title" content="术语命名混乱问题及解决方案 | XX Blog"><meta itemprop=name content="术语命名混乱问题及解决方案 | XX Blog"><meta name=twitter:title content="术语命名混乱问题及解决方案 | XX Blog"><meta name=application-name content="术语命名混乱问题及解决方案 | XX Blog"><meta name=twitter:card content="summary"><meta name=description content="XX 的日常技术博客"><meta name=twitter:description content="XX 的日常技术博客"><meta itemprop=description content="XX 的日常技术博客"><meta property="og:description" content="XX 的日常技术博客"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=stylesheet href=/sass/main.min.ab99ff095f832511e24ffb2fba2b51ad473b2f7e9301d674eba2c6c3a6e8bd81.css></head><script>(function(){const e="ThemeColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="ThemeColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.userColorScheme="dark":document.documentElement.dataset.userColorScheme="light"})()</script><body class=dark><nav class=navbar><div class=container><div class=flex><div><a class=brand href=/><img src=/favicon.ico>
XX Blog</a></div><div class=flex><a href=/archives/>归档</a>
<a href=/posts/>文章</a>
<button id=dark-mode-button><svg class="light" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="1em" height="1em" style="-ms-transform:rotate(360deg);-webkit-transform:rotate(360deg);transform:rotate(360deg)" viewBox="0 0 36 36"><path fill="#ffd983" d="M30.312.776C32 19 20 32 .776 30.312c8.199 7.717 21.091 7.588 29.107-.429C37.9 21.867 38.03 8.975 30.312.776z"/><path d="M30.705 15.915a1.163 1.163.0 101.643 1.641 1.163 1.163.0 00-1.643-1.641zm-16.022 14.38a1.74 1.74.0 000 2.465 1.742 1.742.0 100-2.465zm13.968-2.147a2.904 2.904.0 01-4.108.0 2.902 2.902.0 010-4.107 2.902 2.902.0 014.108.0 2.902 2.902.0 010 4.107z" fill="#ffcc4d"/><rect x="0" y="0" width="36" height="36" fill="rgba(0, 0, 0, 0)"/></svg><svg class="dark" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="1em" height="1em" style="-ms-transform:rotate(360deg);-webkit-transform:rotate(360deg);transform:rotate(360deg)" viewBox="0 0 36 36"><path fill="#ffd983" d="M16 2s0-2 2-2 2 2 2 2v2s0 2-2 2-2-2-2-2V2zm18 14s2 0 2 2-2 2-2 2h-2s-2 0-2-2 2-2 2-2h2zM4 16s2 0 2 2-2 2-2 2H2s-2 0-2-2 2-2 2-2h2zm5.121-8.707s1.414 1.414.0 2.828-2.828.0-2.828.0L4.878 8.708s-1.414-1.414.0-2.829c1.415-1.414 2.829.0 2.829.0l1.414 1.414zm21 21s1.414 1.414.0 2.828-2.828.0-2.828.0l-1.414-1.414s-1.414-1.414.0-2.828 2.828.0 2.828.0l1.414 1.414zm-.413-18.172s-1.414 1.414-2.828.0.0-2.828.0-2.828l1.414-1.414s1.414-1.414 2.828.0.0 2.828.0 2.828l-1.414 1.414zm-21 21s-1.414 1.414-2.828.0.0-2.828.0-2.828l1.414-1.414s1.414-1.414 2.828.0.0 2.828.0 2.828l-1.414 1.414zM16 32s0-2 2-2 2 2 2 2v2s0 2-2 2-2-2-2-2v-2z"/><circle fill="#ffd983" cx="18" cy="18" r="10"/><rect x="0" y="0" width="36" height="36" fill="rgba(0, 0, 0, 0)"/></svg></button></div></div></div></nav><main><div class=container><article><header class=article-header><div class=thumb><div><h1>术语命名混乱问题及解决方案</h1><div class=post-meta><div>By Xiang | <time>May 22, 2023</time>
| 1 minutes</div><div class=tags><a href=/tags/code/>code</a></div></div></div></div></header></article><div class=article-post><h2 id=前言><a href=#%e5%89%8d%e8%a8%80 class=anchor><svg class="icon" aria-hidden="true" focusable="false" height="16" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5.0-3-1.69-3-3.5S2.55 3 4 3h4c1.45.0 3 1.69 3 3.5.0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98.0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98.0-2-1.22-2-2.5.0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45.0 3-1.69 3-3.5S14.5 6 13 6z"/></svg></a>前言</h2><p>在日常开发中，当你看到代码里的 <code>userId</code> 变量时，你无需检查代码的上下文，就猜到它代表的是 <code>user</code> 表的主键 <code>id</code>。但有时候出于各种原因，导致变量实际代表的意义并非我们所想的那样，如果我们按照自己认为的那样进行编码，则可能造成严重问题。</p><h2 id=我遇到的典型案例><a href=#%e6%88%91%e9%81%87%e5%88%b0%e7%9a%84%e5%85%b8%e5%9e%8b%e6%a1%88%e4%be%8b class=anchor><svg class="icon" aria-hidden="true" focusable="false" height="16" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5.0-3-1.69-3-3.5S2.55 3 4 3h4c1.45.0 3 1.69 3 3.5.0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98.0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98.0-2-1.22-2-2.5.0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45.0 3-1.69 3-3.5S14.5 6 13 6z"/></svg></a>我遇到的典型案例</h2><h3 id=1><a href=#1 class=anchor><svg class="icon" aria-hidden="true" focusable="false" height="16" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5.0-3-1.69-3-3.5S2.55 3 4 3h4c1.45.0 3 1.69 3 3.5.0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98.0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98.0-2-1.22-2-2.5.0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45.0 3-1.69 3-3.5S14.5 6 13 6z"/></svg></a>1.</h3><p>某教育公司的 <code>teacher</code> 表里有三个数字字段分别是：<code>id</code>，<code>teacher_id</code>，<code>teacher_uid</code>；其中，<code>id</code> 是自增主键，<code>teacher_id</code> 是发号器生成的全局唯一 <code>id</code>；<code>teacher_uid</code> 是绑定的用户 <code>id</code>。</p><p>当代码里、或其他表字段里出现一个 <code>teacher_id</code> 时，如果不查看上下文，你很难知道它代表的是 <code>teacher</code> 表的哪个字段。曾经就有一位研发在建表时使用 <code>teacher_id</code> 代表了 <code>teacher_uid</code>，导致某些功能查询 <code>teacher</code> 信息失败。</p><p>在设计表时，如果决定使用递增全局唯一 <code>id</code> 时，就没必要再保留主键自增了，把从发号器拿到的全局唯一 <code>id</code> 作为主键存储即可，这样就避免了 <code>teacher_id</code> 的语义问题。再规范使用 <code>teacher_id</code> 与 <code>teacher_uid</code>，则可以避免此类字段引起问题。</p><h3 id=2><a href=#2 class=anchor><svg class="icon" aria-hidden="true" focusable="false" height="16" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5.0-3-1.69-3-3.5S2.55 3 4 3h4c1.45.0 3 1.69 3 3.5.0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98.0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98.0-2-1.22-2-2.5.0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45.0 3-1.69 3-3.5S14.5 6 13 6z"/></svg></a>2.</h3><p>某电子商务公司的支付系统的各个服务中，<code>customer_id</code> 经常用来表示企业用户 <code>id</code>，企业信息、账单、合规认证等各个系统表里及代码里都是用 <code>customer_id</code> 表示企业用户 <code>id</code>。</p><p>后来在开发一个数据统计功能时，某新人研发要根据<strong>订单概要表</strong>统计企业销售数据，代码逻辑是根据此表的 <code>customer_id</code> 进行聚合查询等操作。临上线时发现聚合得到的数据跟其他系统的数据对不上，后来调查发现此处的 <code>customer_id</code> 是消费者用户 <code>id</code>，并非企业 <code>id</code>。</p><p>同一系统中，同一个单词只能代表一种主体，必须确保术语的语义唯一。</p><h3 id=3><a href=#3 class=anchor><svg class="icon" aria-hidden="true" focusable="false" height="16" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5.0-3-1.69-3-3.5S2.55 3 4 3h4c1.45.0 3 1.69 3 3.5.0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98.0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98.0-2-1.22-2-2.5.0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45.0 3-1.69 3-3.5S14.5 6 13 6z"/></svg></a>3.</h3><p>某互联网公司的系统中有如下三张表： <code>swap_result(id, ...)</code>， <code>swap_record(id, ..., swap_result_id)</code>，<code>swap_extrinsic(id, ..., swap_result_id)</code>。</p><p>后面两张表里都有相同数据类型的 <code>swap_result_id</code>。使用其中的 <code>swap_result_id</code> 去 <code>swap_result</code> 表中按主键查询，什么也查不到，就算有能查到的数据，但各种场景都对不上。后来翻代码才发现，<code>swap_record.swap_result_id</code> 是 <code>swap_extrinsic.id</code>，而 <code>swap_extrinsic.swap_result_id</code> 是 <code>swap_record.id</code>，它们跟 <code>swap_result</code> 表毫无关联！</p><p>通常在设计外键关联时，只需要根据业务逻辑把一张表的外键关联另一张表即可。就算是一对一的关系，也无需两张表互相关联。且这里的字段命名存在很大的词不达意问题。</p><h2 id=避免术语不一致><a href=#%e9%81%bf%e5%85%8d%e6%9c%af%e8%af%ad%e4%b8%8d%e4%b8%80%e8%87%b4 class=anchor><svg class="icon" aria-hidden="true" focusable="false" height="16" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5.0-3-1.69-3-3.5S2.55 3 4 3h4c1.45.0 3 1.69 3 3.5.0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98.0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98.0-2-1.22-2-2.5.0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45.0 3-1.69 3-3.5S14.5 6 13 6z"/></svg></a>避免术语不一致</h2><p>术语混淆问题带来的 bug 通常很隐晦，难以在编码阶段发现。而当测试场景不充分时，在测试阶段也可能无法发现这些 bug。一旦上到生产环境，可能造成严重问题：比如使用了错误的 id 导致数据被覆盖，被误删，新增了错误数据等。</p><p>避免术语混淆应从最早的时间开始。</p><h3 id=从立项开始><a href=#%e4%bb%8e%e7%ab%8b%e9%a1%b9%e5%bc%80%e5%a7%8b class=anchor><svg class="icon" aria-hidden="true" focusable="false" height="16" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5.0-3-1.69-3-3.5S2.55 3 4 3h4c1.45.0 3 1.69 3 3.5.0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98.0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98.0-2-1.22-2-2.5.0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45.0 3-1.69 3-3.5S14.5 6 13 6z"/></svg></a>从立项开始</h3><p>在立项初期，项目负责人就应该根据项目涉及到的主体，分别确定其术语，最好附带其英文翻译，这样可以做到多方（前端、后端、客户端等）的命名一致。在立项会或产品评审阶段，各方会对术语达成一致，在各自的文档和代码中使用相同的命名，便于代码阅读、接口理解。</p><h3 id=技术文档与技术评审><a href=#%e6%8a%80%e6%9c%af%e6%96%87%e6%a1%a3%e4%b8%8e%e6%8a%80%e6%9c%af%e8%af%84%e5%ae%a1 class=anchor><svg class="icon" aria-hidden="true" focusable="false" height="16" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5.0-3-1.69-3-3.5S2.55 3 4 3h4c1.45.0 3 1.69 3 3.5.0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98.0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98.0-2-1.22-2-2.5.0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45.0 3-1.69 3-3.5S14.5 6 13 6z"/></svg></a>技术文档与技术评审</h3><p>服务端的技术文档通常要包含以下核心要素：</p><ul><li>数据库表设计，建表语句</li><li>缓存字段命名、值类型</li><li>接口详细定义</li></ul><p>有的系统对代码质量要求较高，可能还需要再技术文档里说明大致的代码框架：</p><ul><li>接口定义</li><li>关键类、字段</li></ul><p>在评审这些与编码直接相关的内容时，应严格把控字段命名：</p><ul><li>与立项定义的关键术语命名一致</li><li>外键命名规范：主键表_id</li><li>缓存字段名确保见名知意；缓存 key 前缀，避免多项目 key 冲突</li><li>关键接口、类、字段术语一致；不要过于简写</li></ul><h3 id=编码><a href=#%e7%bc%96%e7%a0%81 class=anchor><svg class="icon" aria-hidden="true" focusable="false" height="16" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5.0-3-1.69-3-3.5S2.55 3 4 3h4c1.45.0 3 1.69 3 3.5.0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98.0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98.0-2-1.22-2-2.5.0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45.0 3-1.69 3-3.5S14.5 6 13 6z"/></svg></a>编码</h3><p>长一点的名字更能准确表达意思。应少用 tmpXXX 作为作用域较广的变量，而是根据其场景，使用更能体现其意义的名字。</p><p>函数通常是与其他工程师的代码进行交互的入口，所以函数参数的命名更加重要。重要的入口函数加上完整的注释，能够避免很多沟通上的问题；重构函数时也要记得修改注释。</p><p>接口、类的 public 字段等，同样如此。</p><h3 id=代码审查><a href=#%e4%bb%a3%e7%a0%81%e5%ae%a1%e6%9f%a5 class=anchor><svg class="icon" aria-hidden="true" focusable="false" height="16" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5.0-3-1.69-3-3.5S2.55 3 4 3h4c1.45.0 3 1.69 3 3.5.0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98.0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98.0-2-1.22-2-2.5.0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45.0 3-1.69 3-3.5S14.5 6 13 6z"/></svg></a>代码审查</h3><p>代码审查是把控代码质量的最后一道关口，需要认真执行，不能流水账。</p><p>通常提测时就应该开始安排代码审查，上线前再根据上次审查后的变更记录进行增量的审查。</p><p>这样可以给审查留出足够的时间，而不是临上线时，着急上线导致流水账式的审查，导致漏掉一些隐晦的问题。提前审查出的不规范、代码结构不合理等问题，也可以给研发留出充足的时间进行重构，而不是临上线时重构，导致需要重新走一遍测试流程（有些着急上线不重新测试，经常会遇到重构出 bug 的情况）。</p><h2 id=总结><a href=#%e6%80%bb%e7%bb%93 class=anchor><svg class="icon" aria-hidden="true" focusable="false" height="16" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5.0-3-1.69-3-3.5S2.55 3 4 3h4c1.45.0 3 1.69 3 3.5.0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98.0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98.0-2-1.22-2-2.5.0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45.0 3-1.69 3-3.5S14.5 6 13 6z"/></svg></a>总结</h2><p>术语混淆使用导致的问题通常隐晦且对系统有破坏性，在日常工作中需要重视。</p><p>应从立项开始，就对系统的术语进行规范；在项目进行的关键环节，对关键命名进行评审把控，同时提升研发人员素质，才能减少此类故障发生的可能性。</p></div></div><div class=container><nav class="flex container suggested"><a rel=prev href=/posts/coding-with-openai/ title="Previous post (older)"><span>Previous</span>
使用 OpenAI 协作完成项目，好用到离不开</a>
<a rel=next href=/posts/postgresql-create-index-concurrently/ title="Next post (newer)"><span>Next</span>
PostgreSQL 在线创建索引卡住的问题</a></nav></div><div class=container><script src=https://giscus.app/client.js data-repo=xiang-xx/xiang-xx.github.io data-repo-id=R_kgDOI4YfdA data-category=Comment data-category-id=DIC_kwDOI4YfdM4CT7aL data-mapping=pathname data-reactions-enabled=1 data-emit-metadata=0 data-theme=light crossorigin=anonymous async></script><script>function setGiscusTeheme(e){let t=document.querySelector(".giscus iframe");t&&t.contentWindow.postMessage({giscus:{setConfig:{theme:e}}},"https://giscus.app")}addEventListener("message",e=>{if(e.origin!=="https://giscus.app")return;setGiscusTeheme(document.documentElement.dataset.userColorScheme)}),window.addEventListener("onColorSchemeChange",e=>{setGiscusTeheme(e.detail)})</script></div></main></main><footer class="footer flex"><section class=container><nav class=footer-links><a href=/index.xml>RSS</a></nav></section><script defer src=/ts/features.706a523ba43e6d0427c7fdf2b9d05dbd0920d3f12942b453690b495cb2522743.js data-enable-footnotes=true></script></footer></body></html>